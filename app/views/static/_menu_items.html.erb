<% @title = local_assigns[:title] %>
<% @subtitle = local_assigns[:subtitle] %>
<% @additional_info = local_assigns[:additional_info] %>
<% @description = local_assigns[:description] %>
<% @menu_items = local_assigns[:menu_items] %>


<div class="mx-auto max-w-2xl text-center space-y-2 mt-8">
  <% if @title %>
    <h2 id="menu-section-title-<%= @title.parameterize %>" class="heading-section"><%= @title %></h2>
  <% end %>
  <% if @subtitle %>
    <h3 id="menu-section-subtitle-<%= @subtitle.parameterize %>" class="text-xl mt-2 font-gotham-bold tracking-wide text-siam-800 sm:text-3xl uppercase"><%= @subtitle %></h3>
  <% end %>
  <% if @additional_info %>
    <% @additional_info.each do |info| %>
      <p class="my-0 mx-4 text-base text-siam-600 text-balance"><%= info %></p>
    <% end %>
  <% end %>
  <% if @description %>
    <p class="font-gotham-medium mx-4 mb-4 text-lg text-siam-700 text-balance"><%= @description %></p>
  <% end %>
</div>

<div class="mx-auto mx-4 py-4">
  <% if @menu_items.any? %>
    <ul role="list" class="mx-auto grid max-w-xl grid-cols-1 gap-y-2 sm:gap-x-8 sm:gap-y-4 sm:grid-cols-1 sm:max-w-7xl md:gap-x-8 md:gap-y-4 md:grid-cols-1 md:max-w-7xl lg:gap-x-8 lg:gap-y-4 lg:grid-cols-2 lg:max-w-7xl xl:gap-x-8 xl:gap-y-4 xl:grid-cols-2 xl:max-w-7xl 2xl:gap-x-8 2xl:gap-y-4 2xl:grid-cols-3 2xl:max-w-[80%]">
      <% @menu_items.each do |item| %>

        <li class="relative flex flex-row gap-3 sm:gap-4 overflow-hidden mx-4 rounded-xl bg-white shadow-sm hover:shadow-lg transition-all duration-300 <%= item.recommended? ? "ring-2 ring-rope-400" : "border border-siam-200" %>">
          <% if item.recommended? %>
            <div class="absolute top-0 left-0 z-10">
              <p class="text-xs sm:text-sm font-gotham-bold text-siam-950 bg-rope-400 py-1.5 px-4 rounded-tl-xl rounded-br-xl"><%= item.recommended_text.presence || t('menu.default_recommended_text') %></p>
            </div>
          <% end %>

          <!-- Image - Compact but visible -->
          <% item_image = item.has_photos? ? item.photos.first.variant(:thumb) : item.category == "menu" ? "placeholder-food.jpg" : "placeholder-drink.jpg" %>
          <div class="relative w-24 sm:w-28 md:w-32 flex-shrink-0">
            <%= image_tag(item_image, class: "absolute inset-0 size-full object-cover") %>
          </div>

          <!-- Content -->
          <div class="flex flex-col flex-1 py-4 pr-4 <%= item.recommended? ? "pt-12" : "pt-4" %>">
            <!-- Header: Title and Price -->
            <div class="flex items-start justify-between gap-3 mb-2">
              <h3 class="text-base sm:text-lg font-gotham-bold tracking-tight text-siam-900 leading-tight text-balance flex-1"><%= item.title %></h3>
              <span class="text-lg sm:text-xl font-gotham-bold text-rope-600 whitespace-nowrap"><%= item.price %></span>
            </div>

            <!-- Description -->
            <p class="text-sm sm:text-base text-siam-700 leading-relaxed mb-2 flex-1"><%= item.description %></p>

            <!-- Dietary icons - Bottom right -->
            <% if item.options.present? %>
              <div class="flex items-center justify-end gap-1.5">
                <% if item.options.downcase.include?('v') && !item.options.downcase.include?('vo') %>
                  <div class="flex items-center justify-center size-6 rounded-full bg-green-100 flex-shrink-0" title="Vegan">
                    <%= inline_svg_tag 'vegan.svg', class: 'size-3.5 text-green-600' %>
                  </div>
                <% end %>
                <% if item.options.downcase.include?('gf') %>
                  <div class="flex items-center justify-center size-6 rounded-full bg-amber-100 flex-shrink-0" title="Gluten Free">
                    <%= inline_svg_tag 'gluten-free.svg', class: 'size-3.5 text-amber-600' %>
                  </div>
                <% end %>
                <% if item.options.downcase.include?('vo') %>
                  <div class="flex items-center justify-center size-6 rounded-full bg-emerald-100 flex-shrink-0" title="Vegan Option Available">
                    <%= inline_svg_tag 'vegan.svg', class: 'size-3.5 text-emerald-600' %>
                  </div>
                <% end %>
              </div>
            <% end %>
          </div>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p class="mx-4 text-lg text-siam-600 text-balance text-center"><%= t('menu.no_items_found') %></p>
  <% end %>
</div>